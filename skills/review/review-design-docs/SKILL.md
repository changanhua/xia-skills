---
name: review-design-docs
description: 审查设计文档的完整性、详细程度、时效性、一致性、可实施性、技术栈稳定性和潜在风险点。适用于架构设计、技术方案、功能规范等文档的质量审查。
---

# When to use

- 审查架构设计文档（如 architecture.md）
- 审查技术方案文档（如 technical-spec.md）
- 审查功能设计文档
- 在文档评审会议前进行自查
- 在代码实现前验证设计文档质量

# When NOT to use

- 审查代码实现（应使用 code review）
- 审查测试文档（应使用测试审查skill）
- 简单的文档校对（语法、格式检查）

---

# Inputs required from user

- **文档路径**：需要审查的文档路径（必填）
- **审查重点**：是否有特别关注的维度（可选）
- **项目背景**：文档涉及的项目上下文（可选，用于一致性检查）

---

# Workflow

## 步骤 1：读取并分析文档

1. 使用 read_file 工具读取目标文档
2. 识别文档类型（架构/技术方案/功能设计/其他）
3. 提取文档的关键组成部分

## 步骤 2：审查详细程度

检查文档是否包含足够的细节：

| 检查项 | 说明 | 阈值 |
|--------|------|------|
| 目标明确 | 文档有清晰的目标陈述 | 必须 |
| 术语定义 | 关键术语有明确定义 | 建议 |
| 数据模型 | 有数据模型或接口定义 | 架构必需 |
| 流程描述 | 有清晰的流程/步骤说明 | 建议 |
| 示例说明 | 包含使用示例或场景 | 建议 |
| 边界情况 | 描述了边界条件和异常处理 | 建议 |

## 步骤 3：过时检查

验证文档是否与当前实现一致：

1. 检查文档版本/日期信息
2. 对比代码实现（如果有实现）：
   - 模块结构是否一致
   - 接口定义是否匹配
   - 命名规范是否统一
3. 检查"待实现"或"TODO"标记的状态
4. 识别可能需要更新的部分

## 步骤 4：一致性检查

验证文档内部和与其他文档的一致性：

- 术语使用是否一致（同一概念用同一术语）
- 编号和引用是否正确
- 文档格式是否统一
- 与项目其他文档是否有冲突
- 与技术栈版本是否匹配

## 步骤 5：可实施性评估

评估文档能否指导实现：

1. **完整性**：是否包含实现所需的所有必要信息
2. **明确性**：描述是否清晰无歧义
3. **可验证性**：是否有明确的验收标准
4. **依赖关系**：是否明确了依赖项
5. **优先级**：是否有实现顺序建议

## 步骤 6：风险点识别

识别文档中可能存在的问题：

- 缺失的关键信息
- 不清晰的描述
- 潜在的设计问题
- 与现有架构的冲突
- 性能/安全/可扩展性隐患

## 步骤 7：技术栈稳定性评估（可选）

仅当文档涉及前端/桌面应用开发时执行此步骤。如果文档是纯业务逻辑或算法设计，可跳过。

### 7.1 动态识别技术栈

1. 阅读文档，识别涉及的技术栈：
   - 前端框架（React/Vue/Angular）
   - 桌面框架（Electron/Tauri）
   - 状态管理（Redux/Zustand）
   - Web Component
   
2. 根据识别的技术栈，参考 debug-log.md 中的常见问题，检查是否有相关风险

### 7.2 常见技术风险（参考提示）

| 技术领域 | 风险类型 | 检查点 |
|----------|----------|--------|
| React | StrictMode 双挂载 | 是否处理异步竞态 |
| React | useEffect cleanup | 异步操作是否正确取消 |
| Web Component | 生命周期管理 | 实例是否正确清理 |
| 状态管理 | 并发更新 | 是否有状态竞争 |
| 异步请求 | 取消处理 | 组件卸载时是否取消 |

> **提示**: 如果项目有 debug-log.md 或类似的问题记录，优先参考其中的实际问题。

### 7.3 通用检查

- 依赖版本是否明确
- 第三方库是否有已知问题
- 与现有架构是否一致

---

# Output format

审查完成后，按以下格式输出：

```
## 文档审查报告

### 基本信息
- 文档路径: xxx
- 文档类型: xxx
- 审查日期: xxx

### 审查结果

#### 1. 详细程度评分: X/10
[详细说明]

#### 2. 时效性评估: X/10
- 状态: [最新/需要更新/过时]
- 问题: [列出过时内容]

#### 3. 一致性评分: X/10
- 内部一致性: [OK/问题列表]
- 外部一致性: [OK/问题列表]

#### 4. 可实施性评分: X/10
- 完整性: [OK/缺失项]
- 明确性: [OK/模糊项]

#### 5. 完整性评估
- [ ] 目标明确
- [ ] 数据模型完整
- [ ] 接口定义清晰
- [ ] 流程描述完整
- [ ] 边界情况考虑
- [ ] 示例充分

#### 6. 风险点
| 风险级别 | 问题描述 | 建议 |
|----------|----------|------|
| 高 | xxx | xxx |
| 中 | xxx | xxx |
| 低 | xxx | xxx |

#### 7. 技术栈稳定性评估（如果不适用可跳过）
- 框架特性风险: [不适用/已考虑/未考虑/需补充]
- 依赖兼容性: [OK/问题列表]
- 架构一致性: [OK/问题列表]

### 总体评价
[总体评分和建议]

### 改进建议
1. [优先级高]
2. [优先级中]
3. [优先级低]
```

---

# Examples

## Example 1: 审查架构文档

用户输入：
```
请审查 plans/myreader-architecture.md
```

执行流程：
1. 读取文档
2. 检查详细程度（架构图、分层设计、技术栈选型）
3. 检查过时（对比 src/ 目录下的实际代码结构）
4. 检查一致性（术语、编号）
5. 评估可实施性（是否可指导实现）
6. 识别风险点

## Example 2: 审查特定维度

用户输入：
```
请审查 plans/context-management.md，重点关注可实施性和风险点
```

执行流程：
1. 读取文档
2. 重点评估步骤5和步骤6
3. 提供详细的可实施性分析和风险报告

## Example 3: 审查技术栈稳定性

用户输入：
```
请审查 plans/context-management.md，重点关注技术栈稳定性
```

执行流程：
1. 读取文档
2. 重点评估步骤7（技术栈稳定性）
3. 检查文档是否考虑：
   - React StrictMode 双挂载问题
   - Web Component 生命周期管理
   - 异步请求取消处理
   - 组件卸载时的资源清理

---

# Troubleshooting

- **文档不存在**：检查路径是否正确，使用 list_files 确认文件存在
- **文档格式特殊**：检查是否为 Markdown 以外的格式（如 Confluence、Notion）
- **文档过大**：分段读取，先获取目录结构
- **需要对比代码**：先搜索相关代码文件，再进行对比
